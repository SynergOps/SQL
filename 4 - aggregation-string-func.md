# Lets learn how to aggregate and do some text manipulation

Use the previously imported database
```sql
USE wallet_addr;
```
Write a query that returns the total number of wallet_addr in the wallet_addr table.
```sql
SELECT COUNT(customer_id) AS `total wallet_addr` FROM wallet_addr;
```
Write a query that returns the total number of wallet_addr that have a balance greater than 10000.
```sql
SELECT COUNT(customer_id) AS `total wallet_addr with balance` FROM wallet_addr WHERE btc > 10000;
```
Write a query that returns the average balance of all wallet_addr.
```sql
SELECT AVG(btc) AS `average balance` FROM wallet_addr;
```
Write a query that returns the total balance of all wallet_addr.
```sql
SELECT SUM(btc) AS `total balance` FROM wallet_addr;
```
Write a query that returns the smallest balance of all wallet_addr.
```sql
SELECT MIN(btc) AS `smallest balance` FROM wallet_addr;
```
Write a query that returns the largest balance of all wallet_addr.
```sql
SELECT MAX(btc) AS `largest balance` FROM wallet_addr;
```
Write a query that returns the wallet_addr with the highest balance.
```sql
SELECT * FROM wallet_addr ORDER BY btc DESC LIMIT 1;
```
Write a query that returns the wallet_addr with the lowest balance.
```sql
SELECT * FROM wallet_addr ORDER BY btc ASC LIMIT 1;
```
Write a query that returns the total number of wallet_addr that have a balance greater than 10000 and less than 20000.
```sql
SELECT COUNT(customer_id) AS `total wallet_addr with balance between 10000 and 20000` FROM wallet_addr WHERE btc > 10000 AND btc < 20000;
```
Write a query that returns the first 3 characters of the first name of each wallet_addr in the wallet_addr table.
```sql
SELECT SUBSTRING(first_name, 1, 3) AS `first 3 characters of first name` FROM wallet_addr;
```
CONCATENATION 
Write a query that returns the full name of each wallet_addr in the wallet_addr table.
```sql
SELECT CONCAT(first_name, ' ', last_name) AS `full name` FROM wallet_addr;
```
Write a query that returns the full name of each wallet_addr in the wallet_addr table, with a random string of 5 characters added to the end of each name.

```sql
SELECT CONCAT(first_name, ' ', last_name, ' ', SUBSTRING(MD5(RAND()), 1, 5)) AS `full name with random string` FROM wallet_addr;
```

1. **`RAND()`**:
   - This function generates a random floating-point number between 0 (inclusive) and 1 (exclusive). Each time you call `RAND()`, it produces a different random number.

2. **`MD5()`**:
   - This function takes a string as input and returns its MD5 hash. The MD5 hash is a 32-character hexadecimal number. In this case, the input to `MD5()` is the random number generated by `RAND()`. Since `RAND()` produces a different number each time, the MD5 hash will also be different each time.

3. **`SUBSTRING()`**:
   - This function extracts a substring from a given string. It takes three arguments: the string to extract from, the starting position, and the length of the substring. In this case, `SUBSTRING(MD5(RAND()), 1, 5)` extracts the first 5 characters of the MD5 hash.

Putting it all together:
- `RAND()` generates a random number.
- `MD5(RAND())` converts that random number into a 32-character MD5 hash.
- `SUBSTRING(MD5(RAND()), 1, 5)` extracts the first 5 characters of that MD5 hash.

This combination of functions is often used to generate a short, random string.

LEFT, RIGHT, and MID
Write a query that returns the first 3 characters of the first name of each wallet_addr in the wallet_addr table.
```sql
SELECT LEFT(first_name, 3) AS `first 3 characters of first name` FROM wallet_addr;
```
Write a query that returns the last 3 characters of the last name of each wallet_addr in the wallet_addr table.
```sql
SELECT RIGHT(last_name, 3) AS `last 3 characters of last name` FROM wallet_addr;
```
Write a query that returns the 4th to 6th characters of the first name of each wallet_addr in the wallet_addr table.
```sql
SELECT MID(first_name, 4, 3) AS `4th to 6th characters of first name` FROM wallet_addr;
```
Lowercase and Uppercase
Write a query that returns the first name of each wallet_addr in lowercase.
```sql
SELECT LOWER(first_name) AS `lowercase first name` FROM wallet_addr;
```
Write a query that returns the last name of each wallet_addr in uppercase.
```sql
SELECT UPPER(last_name) AS `uppercase last name` FROM wallet_addr;
```
Length and Trim
Write a query that returns the length of the first name of each wallet_addr in the wallet_addr table.
```sql
SELECT LENGTH(first_name) AS `length of first name` FROM wallet_addr;
```
Write a query that returns the first name of each wallet_addr in the wallet_addr table, with leading and trailing spaces removed. (trim, ltrim and rtrim)
```sql
SELECT TRIM(address) AS `address without leading and trailing spaces` FROM wallet_addr;
```
Write a query to remove spaces from the address column
```sql
SELECT REPLACE(address, ' ', '') AS `address without spaces` FROM wallet_addr;
```